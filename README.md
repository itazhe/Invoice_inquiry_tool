#### 微信授权

##### 1.接口地址

*

##### 2.返回格式

json

##### 3.请求方式

http post

##### 4.请求示例

*

##### 5.请求参数

| 名称     | 必填 | 类型   | 说明     |
| -------- | ---- | ------ | -------- |
| nickcode | 是   | string | 登录凭证 |

##### 6.返回参数说明

| 名称 | 类型   | 说明                       |
| ---- | ------ | -------------------------- |
| id   | string | 通过openid来锁定使用人微信 |

##### 7.json返回示例

{

’id'：1341rd1f314

}

##### 8.功能详解

把nickcode带入网址发出请求，返回openid字段



#### 登录

##### 1.接口地址

*

##### 2.返回格式

json

##### 3.请求方式

http  post

##### 4.请求示例

*

##### 5.请求参数

| 名称     | 必填 | 类型   | 说明                       |
| -------- | ---- | ------ | -------------------------- |
| username | 是   | string | 用户名                     |
| password | 是   | string | 密码                       |
| nickname | 是   | string | 使用者微信名               |
| id       | 是   | string | 通过openid来锁定使用人微信 |

##### 6.返回参数说明

| 名称 | 类型 | 说明                               |
| ---- | ---- | ---------------------------------- |
| req  | json | 返回状态码1：登录成功，0：登录失败 |

##### 7.json返回示例

{

’status'：1           

}

##### 8.功能详解

每次登录只比对用户名和密码，并向记录数据库中插入用户名，微信名，      	id和当前时间 



#### 扫描录入

##### 1.接口地址



##### 2.返回格式

json

##### 3.请求方式

http  post

##### 4.请求示例



##### 5.请求参数

| 名称    | 必填 | 类型   | 说明               |
| ------- | ---- | ------ | ------------------ |
| i_infor | 是   | string | 扫描得到的发票信息 |

##### 6.返回参数说明

| 名称 | 类型 | 说明                                                     |
| ---- | ---- | -------------------------------------------------------- |
| data | json | 发票信息，包括发票代码、发票号码、开票日期、校验码、金额 |

##### 7.json返回示例

{

'msg': [..........]

}





#### 查真伪功能

##### 1.接口地址  

*

##### 2.返回格式

json

##### 3.请求方式

http  post

##### 4.请求示例



##### 5.请求参数

| 名称           | 必填 | 类型   | 说明                       |
| -------------- | ---- | ------ | -------------------------- |
| invoice_code   | 是   | int    | 发票代码                   |
| invoice_number | 是   | int    | 发票号码                   |
| invoice_date   | 是   | string | 开票日期                   |
| code           | 否   | int    | 检验码                     |
| money          | 否   | int    | 发票金额                   |
| username       | 是   | string | 用户名                     |
| nickname       | 是   | string | 微信名                     |
| id             | 是   | string | 通过openid来锁定使用人微信 |

##### 6.返回参数说明

| 名称 | 类型 | 说明                                                         |
| ---- | ---- | ------------------------------------------------------------ |
| req  | json | 返回发票类型和状态码0：验证为假，1：验证为真，2：发票已存在，3：单张发票验证不能超过5次，4：验真伪次数不足 |

##### 7.json返回示例

{

’status'：1，

i_type:  '发票类型'           

}

##### 8.详解

每次查询后向数据库插入用户名，微信名，id和当前时间作为查询记录





#### 发票保存功能

##### 1.接口地址 

*

##### 2.返回格式

json

##### 3.请求方式

http  post

##### 4.请求示例

*

##### 5.请求参数

| 名称           | 必填 | 类型   | 说明     |
| -------------- | ---- | ------ | -------- |
| invoice_type   | 是   | string | 发票类型 |
| invoice_code   | 是   | int    | 发票代码 |
| invoice_number | 是   | int    | 发票号码 |
| invoice_date   | 否   | string | 开票日期 |
| code           | 否   | int    | 检验码   |
| money          | 是   | int    | 发票金额 |
| invoice_rate   | 否   | int    | 发票税率 |
| invoice_amount | 否   | int    | 发票税额 |
| price_tax      | 否   | int    | 价税合计 |
| name           | 否   | string | 报销人员 |
| department     | 否   | string | 报销部门 |
| invoice_entity | 否   | string | 开票单位 |
| remark         | 否   | string | 备注     |
| username       | 是   | string | 用户名   |

##### 6.返回参数说明

| 名称 | 类型 | 说明                                                      |
| ---- | ---- | --------------------------------------------------------- |
| req  | json | 返回状态码0: 发票已存在，1：保存成功，2：关键信息不能为空 |

##### 7.json返回示例

{

’status'：1           #  1表示保存成功，2表示关键信息不能为空

}





#### 发票验重功能

##### 1.接口地址

*

##### 2.返回格式

json

##### 3.请求方式

http  post

##### 4.请求示例        

*

##### 5.请求参数

| 名称         | 必填 | 类型   | 说明                                                         |
| ------------ | ---- | ------ | ------------------------------------------------------------ |
| num          | 是   | int    | 页数，初值为0                                                |
| input_infor  | 否   | string | 用户输入的查询信息，包含报销人员、发票号码、发票代码中的一个 |
| select_date1 | 是   | string | 用户选择查询发票记录的开始日期                               |
| select_date2 | 是   | string | 用户选择查询发票记录的结束日期                               |
| username     | 是   | string | 用户名                                                       |

##### 6.返回参数说明

| 名称 | 类型 | 说明                                                         |
| ---- | ---- | ------------------------------------------------------------ |
| data | json | json中列表包含手动录入请求参数的所有字段和录入日期 和 总页数(放最后) |
| req  | json | 返回状态码0，表示无记录。req不为0时为有记录，返回data        |

##### 7.json返回示例

{

​	‘0’：{‘0’: [1231231231, azhe, 博政]}，

​	‘1’：{‘1’：[1231231231, azhe, 博政]}，

​		........           # 有记录时返回的json示例

}

{

'status'：0       # 表示无记录

}

##### 8.功能详细

关于验重问题：接收数据先判断，如果开始和结束日期相同，那么只通过输入框，即input_infor接收到的值来查询，如果不相同，就要结合日期和input_infor来查询，这里要注意可能只用日期来查询所有录入记录

关于分页问题：接收数据后先按验重找出数据，然后用数据的条数除以4向上取整返回页数和数据，此地方与消费记录相同





#### 消费记录功能

##### 1.接口地址

*

##### 2.返回格式

json

##### 3.请求方式

http  post

##### 4.请求示例        



##### 5.请求参数      

| 名称         | 必填 | 类型   | 说明                           |
| ------------ | ---- | ------ | ------------------------------ |
| num          | 是   | string | 页数，初值为0                  |
| select_date1 | 是   | string | 用户选择查询发票记录的开始日期 |
| select_date2 | 是   | string | 用户选择查询发票记录的结束日期 |
| username     | 是   | string | 用户名                         |

##### 6.返回参数说明

| 名称 | 类型 | 说明                                                         |
| ---- | ---- | ------------------------------------------------------------ |
| data | json | json中列表包含手动录入请求参数的所有字段、录入日期、总消费条数、剩余消费条数 |
| req  | json | 返回状态码  0 ，表示无记录。req不为0时为有记录，返回data     |

##### 7.json返回示例

有记录时返回的json示例

{

'msg'：{‘0': [1231231231, azhe, 博政],  ‘1': [1231231231, azhe, 博政],    .........},

'all'：{'all1': 1000},      #总消费条数

'sur'：{'sur1'：500}        #剩余消费条数

}

##### 8.详解

每回调用返回4条数据







#### 上传PDF

##### 1.接口地址  

*

##### 2.返回格式

json

##### 3.请求方式

http  post

##### 4.请求示例

*

##### 5.请求参数

| 名称          | 必填 | 类型   | 说明                       |
| ------------- | ---- | ------ | -------------------------- |
| tempFilePaths | 是   | string | PDF信息                    |
| username      | 是   | string | 用户名                     |
| nickname      | 是   | string | 微信名                     |
| id            | 是   | string | 通过openid来锁定使用人微信 |

##### 6.返回参数说明

| 名称 | 类型 | 说明                                                         |
| ---- | ---- | ------------------------------------------------------------ |
| req  | json | 返回发票数据和状态码0：验证为假，1：验证为真，2：发票已存在 4：验真伪次数不足 |

##### 7.json返回示例

{

’status'：1，

'msg_main': [发票代码，发票号码，发票日期，检验码，发票金额]  ，

'i_type':	发票类型，

}

##### 8.详解

每次查询后向数据库插入用户名，微信名，id和当前时间作为查询记录

